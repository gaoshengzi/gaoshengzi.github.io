<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>同源策略 | gaoshengzi Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="一.什么是同源策略同源策略，它是由 Netscape 提出的一个著名的安全策略，现在所有的可支持 javascript 的浏览器都会使用这个策略。">
<meta property="og:type" content="article">
<meta property="og:title" content="同源策略">
<meta property="og:url" content="http://yoursite.com/2014/10/13/同源策略/index.html">
<meta property="og:site_name" content="gaoshengzi Blog">
<meta property="og:description" content="一.什么是同源策略同源策略，它是由 Netscape 提出的一个著名的安全策略，现在所有的可支持 javascript 的浏览器都会使用这个策略。">
<meta property="og:updated_time" content="2016-10-19T04:45:23.923Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="同源策略">
<meta name="twitter:description" content="一.什么是同源策略同源策略，它是由 Netscape 提出的一个著名的安全策略，现在所有的可支持 javascript 的浏览器都会使用这个策略。">
  
    <link rel="alternate" href="/atom.xml" title="gaoshengzi Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">gaoshengzi Blog</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">永远要相信边上的人比你聪明。</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-同源策略" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/10/13/同源策略/" class="article-date">
  <time datetime="2014-10-13T10:49:14.000Z" itemprop="datePublished">2014-10-13</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      同源策略
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="一-什么是同源策略"><a href="#一-什么是同源策略" class="headerlink" title="一.什么是同源策略"></a>一.什么是同源策略</h2><p>同源策略，它是由 <code>Netscape</code> 提出的一个著名的安全策略，现在所有的可支持 <code>javascript</code> 的浏览器都会使用这个策略。<br>　　<br><a id="more"></a></p>
<h3 id="为什么需要同源策略，这里举个例子："><a href="#为什么需要同源策略，这里举个例子：" class="headerlink" title="为什么需要同源策略，这里举个例子："></a>为什么需要同源策略，这里举个例子：</h3><p>　   假设现在没有同源策略，会发生什么事情呢？大家知道，JavaScript可以做很多东西，比如：读取/修改网页中某个值。恩，你现在打开了浏览器，在一 个tab窗口中打开了银行网站，在另外一个tab窗口中打开了一个恶意网站，而那个恶意网站挂了一个的专门修改银行信息的JavaScript，当你访问 这个恶意网站并且执行它JavaScript时，你的银行页面就会被这个JavaScript修改，后果会非常严重！而同源策略就为了防止这种事情发生。</p>
<p> 　<br>　 　比如说，浏览器的两个tab页中分别打开了<a href="http://www.baidu.com/index.html" target="_blank" rel="external"></a>和<a href="http: //www.google.com/index.html" target="_blank" rel="external"></a>，其中，JavaScript1和JavaScript3是属于百度的脚本，而 JavaScript2是属于谷歌的脚本，当浏览器的tab1要运行一个脚本时，便会进行同源检查，只有和www.baidu.com同源的脚本才能被执 行，所谓同源，就是指域名、协议、端口相同。所以，tab1只能执行JavaScript1和JavaScript3脚本，而JavaScript2不能 执行，从而防止其他网页对本网页的非法篡改。<br>如果两个页面拥有相同的协议（protocol），端口（如果指定），和主机，那么这两个页面就属于同一个源（origin）。</p>
<h4 id="下表给出了相对http-store-company-com-dir-page-html同源检测的示例"><a href="#下表给出了相对http-store-company-com-dir-page-html同源检测的示例" class="headerlink" title="下表给出了相对http://store.company.com/dir/page.html同源检测的示例:"></a>下表给出了相对<a href="http://store.company.com/dir/page.html同源检测的示例" target="_blank" rel="external">http://store.company.com/dir/page.html同源检测的示例</a>:</h4><p><strong>URL</strong>            &nbsp;&nbsp;<strong>结果</strong>&nbsp;&nbsp;     <strong>原因</strong></p>
<p><a href="http://store.company.com/dir2/other.html" target="_blank" rel="external">http://store.company.com/dir2/other.html</a>        <em>成功</em><br><a href="http://store.company.com/dir/inner/another.html" target="_blank" rel="external">http://store.company.com/dir/inner/another.html</a>    <em>成功</em><br><a href="https://store.company.com/secure.html" target="_blank" rel="external">https://store.company.com/secure.html</a>    <em>失败</em>    协议不同<br><a href="http://store.company.com:81/dir/etc.html" target="_blank" rel="external">http://store.company.com:81/dir/etc.html</a>    <em>失败</em>    端口不同<br><a href="http://news.company.com/dir/other.html" target="_blank" rel="external">http://news.company.com/dir/other.html</a>    <em>失败</em>    主机名不同</p>
<p><strong>参见</strong> <a href="origin definition for file: URLs."></a></p>
<h3 id="源继承"><a href="#源继承" class="headerlink" title="源继承"></a>源继承</h3><p>来自about:blank，javascript:和data:URLs中的内容，继承了将其载入的文档所指定的源，因为它们的URL本身未指定任何关于自身源的信息。</p>
<h3 id="IE特例"><a href="#IE特例" class="headerlink" title="IE特例"></a>IE特例</h3><p>在处理同源策略的问题上，IE存在 <strong>两个</strong> 主要的不同之处。</p>
<h4 id="授信范围（Trust-Zones）："><a href="#授信范围（Trust-Zones）：" class="headerlink" title="授信范围（Trust Zones）："></a>授信范围（Trust Zones）：</h4><p>两个相互之间高度互信的域名，如公司域名（corporate domains），不遵守同源策略的限制。</p>
<h4 id="端口："><a href="#端口：" class="headerlink" title="端口："></a>端口：</h4><p>IE未将端口号加入到同源策略的组成部分之中，因此 <a href="http://company.com:81/index.html" target="_blank" rel="external">http://company.com:81/index.html</a> 和<a href="http://company.com/index.html" target="_blank" rel="external">http://company.com/index.html</a>  属于同源并且不受任何限制。</p>
<p>这些例外是非标准的，其它浏览器也未做出支持，但会助于开发基于window RT IE的应用程序。</p>
<p><strong>变更源</strong></p>
<p>页面可以改变本身的源，但会受到一些限制。脚本可以设置document.domain 的值为当前域的一个后缀<br>在同源策略中有一个例外，脚本可以设置 document.domain 的值为当前域的一个后缀，如果这样做的话，短的域将作为后续同源检测的依据。例如，假设在 <a href="http://store.company.com/dir/other.html" target="_blank" rel="external">http://store.company.com/dir/other.html</a> 中的一个脚本执行了下列语句：</p>
<p><code>document.domain = &quot;company.com&quot;;</code></p>
<p>这条语句执行之后，页面将会成功地通过对 <a href="http://company.com/dir/page.html" target="_blank" rel="external">http://company.com/dir/page.html</a> 的同源检测。而同理，company.com 不能设置 document.domain 为 othercompany.com.<br>浏览器单独保存端口号。任何的赋值操作，包括document.domain = documen.domain都会以null值覆盖掉原来的端口号。因此company.com:8080页面的脚本不能仅通过设置document.domain = “company.com”就能与company.com通信。赋值时必须带上端口号，以确保端口号不会为null。</p>
<p><em>附注：</em>  使用document.domain来安全是让子域访问其父域，需要同时将子域和父域的document.domain设置为相同的值。必须要这么做，即使是简单的将父域设置为其原来的值。没有这么做的话可能导致授权错误。</p>
<h3 id="跨域网络访问"><a href="#跨域网络访问" class="headerlink" title="跨域网络访问"></a>跨域网络访问</h3><p>同源策略控制了不同源之间的交互，例如在使用XMLHttpRequest 或  标签时则会受到同源策略的约束。交互通常分为 <strong>三类</strong>：</p>
<ol>
<li><p>通常允许进行跨域写操作（Cross-origin writes）。例如链接（links），重定向以及表单提交。特定少数的HTTP请求需要添加 preflight。</p>
</li>
<li><p>通常允许跨域资源嵌入（Cross-origin embedding）。之后下面会举例说明。</p>
</li>
<li><p>通常不允许跨域读操作（Cross-origin reads）。但常可以通过内嵌资源来巧妙的进行读取访问。例如可以读取嵌入图片的高度和宽度，调用内嵌脚本的方法，或availability of an embedded resource。</p>
</li>
</ol>
<h5 id="以下是一些可以跨域内嵌的资源示例："><a href="#以下是一些可以跨域内嵌的资源示例：" class="headerlink" title="以下是一些可以跨域内嵌的资源示例："></a>以下是一些可以跨域内嵌的资源示例：</h5><p>标签嵌入跨域脚本。语法错误信息只能在同源脚本中捕捉到。<br> 标签嵌入CSS。由于CSS的松散的语法规则，CSS的跨域需要一个设置正确的Content-Type消息头。不同浏览器有不同的限制： IE, Firefox, Chrome, Safari (跳至CVE-2010-0051)部分 和 Opera。<br> 嵌入图片。支持的图片格式包括PNG,JPEG,GIF,BMP,SVG,…<br> 嵌入多媒体资源。<br> ,  和 的插件。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2014/10/13/同源策略/" data-id="ciuuwf0dm000d8cucg9mvmkxa" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/同源/">同源</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2014/10/14/跨域资源共享CORS详解/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          跨域资源共享CORS详解
        
      </div>
    </a>
  
  
    <a href="/2014/10/13/移动端与PC端开发的不同/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">移动端与PC端开发的不同</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/AJAX请求/">AJAX请求</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/PC端/">PC端</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/JavaScript/">JavaScript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/angularjs/">angularjs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/file/">file</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/html/">html</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/travis-CI/">travis_CI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/内核/">内核</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/同源/">同源</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/懒加载/">懒加载</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/模块化/">模块化</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/科学上网/">科学上网</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/移动端/">移动端</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/跨域/">跨域</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/JavaScript/" style="font-size: 10px;">JavaScript</a> <a href="/tags/angularjs/" style="font-size: 10px;">angularjs</a> <a href="/tags/file/" style="font-size: 10px;">file</a> <a href="/tags/html/" style="font-size: 10px;">html</a> <a href="/tags/travis-CI/" style="font-size: 10px;">travis_CI</a> <a href="/tags/内核/" style="font-size: 10px;">内核</a> <a href="/tags/同源/" style="font-size: 10px;">同源</a> <a href="/tags/懒加载/" style="font-size: 10px;">懒加载</a> <a href="/tags/模块化/" style="font-size: 10px;">模块化</a> <a href="/tags/科学上网/" style="font-size: 10px;">科学上网</a> <a href="/tags/移动端/" style="font-size: 10px;">移动端</a> <a href="/tags/跨域/" style="font-size: 10px;">跨域</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/06/">June 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/05/">May 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/12/">December 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/11/">November 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/10/">October 2014</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2015/06/15/文件上传/">文件上传</a>
          </li>
        
          <li>
            <a href="/2015/05/26/travis-CI测试/">travis_CI测试</a>
          </li>
        
          <li>
            <a href="/2014/12/21/懒加载/">懒加载</a>
          </li>
        
          <li>
            <a href="/2014/11/11/浏览器内核/">浏览器内核</a>
          </li>
        
          <li>
            <a href="/2014/10/25/HTML优化技巧/">HTML优化技巧</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2016 gaoshengzi<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>